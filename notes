check max_endstop config

Motor 3 --> enabled, gpio 8, min_endstop disabled
Motor 2 --> disabled, gpio 0, min_endstop disabled --> fixed
Motor 1 --> disabled, gpio 0, min_endstop disabled --> fixed 

error:

odrive0 was uncomnfigured!!!

convention:
limit axis 0 -- gpio 2
limit axis 1 -- gpio 8

Superstition:
it is recommended to wait 10 seconds before rebooting odrive after saving configuration
and waiting 5 seconds after to reconnect

gpio 13, 16, 20 on RPI for limit switches


switch to shorter cables

disable endstops on odrive, increase current limit

encoder mounting plate is extremely loose on motor 1. probably why it lost its index position.

position controll works on motor 2 and 3. need to find index before position control works


working settings: 
need to increase current to support weight of arm assembly
current_lim = 40
requested_current_range = 60
calibration_current = 25

if swingd back fast, change motor direction, possibly just reboot and try again.

homing function

switches need debounce? Arms are not rising to switches before it is triggered -- Done




add negative velocity control to RPiOdrive lib. -- its there but I cannot get it to work rn


ODRive gpio are 3.3v but 5v compliant. Encoders being powered off 5v can be a problem.

got all three motors homed with limit switch. after third homes, motors 1 and 2 give out. probasbly a current control problem

TODO:
fix current control problem + tune pos_gain to remove vibrations


TODO:
create README documentation with ODrive info, commands and usage, etc
create config file of current ODrive config for future reference
setup pycharm with RPI - remote deployment
setup slack channel
(me) -- find new tablet or something to work with - stop using blake's tablet
note: since using rpi for stop switches, do not need new firmware
figure out how to use endstops with ODrive
figure out how to set a negative velocity

put ODrives on top of project
put power supply inside base of project
cable management

tighten all loose bolts
install missing bolts in arm
finalize mechanical
create HAT for RPi if limit switches + ODrive dont work
finalize electrical

finish homing function
test setting three positions at once, one per motor
tune current settings
tune proportional control values -- stop wobble and get faster response
lots of testing

implement kinematics and verfy working with joystick control test program
modularize code and create delta-arm class/API
DONE HARDWARE PROGRAMING

install UI on RPi and test displays
install hardware backend delta-arm API into UI front end code
lots of testing and iterative modifications


figure out why motors fail!
axis error 0x40
motor error 0x1
its doing the thing where it goes up then slams back down again.



motor encoder cables were loose and one was detached. Creating more permant encoder cable solution.
Using two different versions of ODrive board. Motor 1 and 2 are connected to an odrive V 3.5 and motor 3 is connected to an odrive v 3.6 --> might be a cause of some problems.

odrive v3.3 and onwards have 5v tolerant pins. should we power encoders from 3.3v? maybe continue using 5v to account for any voltage drop in cables. 
odrive v3.5 and onwards have noise suppression filters on the default step/dir pins. --> filter might cause a problem with something.
*** for predictable results only have one feature enabled per any one pin *** --> double check this with the encoder and limit switch pins.
see odrive --> interfaces documentation for more information

redoing motor calibration per Blake's request.
will then double check index posiion when new encoder cables are ready.
will then make sure that the arms are securely screwed in with all the skrew holes used (all four with the right skrew sizes and threads. not this mix mash thats been going on)

Only 2 and either 8 OR 9 -- figure out if it is 8 or 9 that works -- with GPIO/limit switches

Odrive 3.5 and 3.6 run the same firmware, no significant difference





current settings -- lower current to defaults? motor calibration failing with changed settings motor error 0x1

new encoder extensions work
now that the cables are plugged back in the motors started kind of workikng again
motor 2 has a massive vibration when in position control -- might be due to high current and lack of load. should eventually adjust p loop gains?
motor 1 does not calibrate. calibration fails -- motor error 0x1
motor 3 works?

trying to fix motor calibration error by lower current

calibration current of 15 amps works!!! not 20 or 25 (was at 25)

motor calibration complete -- index and hold working on motor 1 -- have not set calibration current back

3 amps homing and 2 amps holding, no load -- motor 1


motor 2 and 3 are great!
motor 1 is still to rough to work with. maybe recalibrate with lower current limit (10A??)
fix motor 1 and then add arms


recalibrated the motor 1 again -- went smoothly
index and hold is still very violent. After pushing it for a moment it calmed down significantly enough to be usable
putting the arm back on motor 1 to test

just found that the peice of metal that connects the bicep to the motor and thus the encoder, was loosly connected to the motor. The wiggle is what I think could have been the cause

The arm works great when weighted down, need to tighten motor mountings. But in order to do that we will need to re index the encoders

tested motor 3 velocity -- works positive and negative


---------------


motor 1 -- enocder is indexed, motor recalibrated. Index and hold works without arm. With bicep it indexes then maxes out the powersupply at around 24 amps. need to fix, probably current settings again. change calbration current?
motor 2 -- bicep is friction welded into place -- continued testing was made it imovable. Hammering the bicep caused the shaft of the encoder to loosen completely. need to remove the arm assembly, take off and repair the bicep, reinstall the encoder (super glue? seems to be holding on motor 1). Motor 1 cables have been getting caught on motor 2's bicep causing issues during index search. need to ziptie down if not already. index not finding
motor 3 is still working fine

just tweaked the calibration current for motor1. It is not the calibration that is drawing current: it is the position control. my theory is that since the oscilations never went away, they are still there even with the bicep on it. The oscilations are quite violent and the the additional load of the bicep might have caused the power draw if it is still trying to rapidly change direction. calibration current changed from 15 --> 25 amps.

taking off motor 2 for repairs. encoder gear head fell off of the axle. Super glue works great. The mount for the encoder on motor 2 has only one of its screws visible from the top of the assembly. May need to remove one of the aluminum extrusion supports.

motor 2 was using the yellow encoder gear head. The others are green. they seem to be interchangable but green looks slightly smaller

motor 1 and motor 2 have identical controller configrations.

velocity control works on motor 1 without bicep and motor 3 (forgot if tested, I think it works) motor 2 could have been working, I also forgot

____________
later on the same day....
got motor 2 up and running again. didn't need to use super glue


redid motor 1 calibration -- no longer draws 20A. insane rattling but atleast it works. 
checked vimdiff on the previous and new clibration, current sense paramaters changed a significant amount.

all three motors can index and hold?


----------------

motor 2 can set velocity negative AND positive with bicep on. no problem. negative velocity moves the arm up. -20 is a good value for the homing sequence.


